function virXY = COMNq(ObComX, ObComY, virJ, bodyJ, lforeJ, rforeJ, lhindJ, rhindJ, dvirJ, dbodyJ, dlforeJ, drforeJ, dlhindJ, drhindJ, d2virJ, d2bodyJ, d2lforeJ, d2rforeJ, d2lhindJ, d2rhindJ, bodyM, lforeM, rforeM, lhindM, rhindM, bodyL, lforeL, rforeL, lhindL, rhindL, bodyW, lforeW, rforeW, lhindW, rhindW, bodyH, lforeH, rforeH, lhindH, rhindH, shopelP)
q1 = virJ(1,1); q2 = virJ(1,2); q3 = virJ(1,3);
q4 = bodyJ(1,1); q5 = bodyJ(1,2);
q6 = lforeJ(1,1); q7 = lforeJ(1,2); q8 = lforeJ(1,3); q9 = lforeJ(1,4); q10 = lforeJ(1,5); q11 = lforeJ(1,6); q12 = lforeJ(1,7);
q13 = rforeJ(1,1); q14 = rforeJ(1,2); q15 = rforeJ(1,3); q16 = rforeJ(1,4); q17 = rforeJ(1,5); q18 = rforeJ(1,6); q19 = rforeJ(1,7);
q20 = lhindJ(1,1); q21 = lhindJ(1,2); q22 = lhindJ(1,3); q23 = lhindJ(1,4); q24 = lhindJ(1,5); q25 = lhindJ(1,6); q26 = lhindJ(1,7);
q27 = rhindJ(1,1); q28 = rhindJ(1,2); q29 = rhindJ(1,3); q30 = rhindJ(1,4); q31 = rhindJ(1,5); q32 = rhindJ(1,6); q33 = rhindJ(1,7);

dq1 = dvirJ(1,1); dq2 = dvirJ(1,2); dq3 = dvirJ(1,3);
dq4 = dbodyJ(1,1); dq5 = dbodyJ(1,2);
dq6 = dlforeJ(1,1); dq7 = dlforeJ(1,2); dq8 = dlforeJ(1,3); dq9 = dlforeJ(1,4); dq10 = dlforeJ(1,5); dq11 = dlforeJ(1,6); dq12 = dlforeJ(1,7);
dq13 = drforeJ(1,1); dq14 = drforeJ(1,2); dq15 = drforeJ(1,3); dq16 = drforeJ(1,4); dq17 = drforeJ(1,5); dq18 = drforeJ(1,6); dq19 = drforeJ(1,7);
dq20 = dlhindJ(1,1); dq21 = dlhindJ(1,2); dq22 = dlhindJ(1,3); dq23 = dlhindJ(1,4); dq24 = dlhindJ(1,5); dq25 = dlhindJ(1,6); dq26 = dlhindJ(1,7);
dq27 = drhindJ(1,1); dq28 = drhindJ(1,2); dq29 = drhindJ(1,3); dq30 = drhindJ(1,4); dq31 = drhindJ(1,5); dq32 = drhindJ(1,6); dq33 = drhindJ(1,7);

d2q1 = d2virJ(1,1); d2q2 = d2virJ(1,2); d2q3 = d2virJ(1,3);
d2q4 = d2bodyJ(1,1); d2q5 = d2bodyJ(1,2);
d2q6 = d2lforeJ(1,1); d2q7 = d2lforeJ(1,2); d2q8 = d2lforeJ(1,3); d2q9 = d2lforeJ(1,4); d2q10 = d2lforeJ(1,5); d2q11 = d2lforeJ(1,6); d2q12 = d2lforeJ(1,7);
d2q13 = d2rforeJ(1,1); d2q14 = d2rforeJ(1,2); d2q15 = d2rforeJ(1,3); d2q16 = d2rforeJ(1,4); d2q17 = d2rforeJ(1,5); d2q18 = d2rforeJ(1,6); d2q19 = d2rforeJ(1,7);
d2q20 = d2lhindJ(1,1); d2q21 = d2lhindJ(1,2); d2q22 = d2lhindJ(1,3); d2q23 = d2lhindJ(1,4); d2q24 = d2lhindJ(1,5); d2q25 = d2lhindJ(1,6); d2q26 = d2lhindJ(1,7);
d2q27 = d2rhindJ(1,1); d2q28 = d2rhindJ(1,2); d2q29 = d2rhindJ(1,3); d2q30 = d2rhindJ(1,4); d2q31 = d2rhindJ(1,5); d2q32 = d2rhindJ(1,6); d2q33 = d2rhindJ(1,7);

q=[q1; q2; q3; q4; q5; q6; q7; q8; q9; q10; q11; q12; q13; q14; q15; q16; q17; q18; q19; q20; q21; q22; q23; q24; q25; q26; q27; q28; q29; q30; q31; q32; q33];
dq=[dq1; dq2; dq3; dq4; dq5; dq6; dq7; dq8; dq9; dq10; dq11; dq12; dq13; dq14; dq15; dq16; dq17; dq18; dq19; dq20; dq21; dq22; dq23; dq24; dq25; dq26; dq27; dq28; dq29; dq30; dq31; dq32; dq33];
d2q=[d2q1; d2q2; d2q3; d2q4; d2q5; d2q6; d2q7; d2q8; d2q9; d2q10; d2q11; d2q12; d2q13; d2q14; d2q15; d2q16; d2q17; d2q18; d2q19; d2q20; d2q21; d2q22; d2q23; d2q24; d2q25; d2q26; d2q27; d2q28; d2q29; d2q30; d2q31; d2q32; d2q33];

m1 = bodyM(1,1); m2 = bodyM(1,2); m3 = bodyM(1,3);
m4 = lforeM(1,1); m5 = lforeM(1,2); m6 = lforeM(1,3);
m7 = rforeM(1,1); m8 = rforeM(1,2); m9 = rforeM(1,3);
m10 = lhindM(1,1); m11 = lhindM(1,2); m12 = lhindM(1,3);
m13 = rhindM(1,1); m14 = rhindM(1,2); m15 = rhindM(1,3);

L1 = bodyL(1,1); L2 = bodyL(1,2); L3 = bodyL(1,3);
L4 = lforeL(1,1); L5 = lforeL(1,2); L6 = lforeL(1,3);
L7 = rforeL(1,1); L8 = rforeL(1,2); L9 = rforeL(1,3);
L10 = lhindL(1,1); L11 = lhindL(1,2); L12 = lhindL(1,3);
L13 = rhindL(1,1); L14 = rhindL(1,2); L15 = rhindL(1,3);

W1 = bodyW(1,1); W2 = bodyW(1,2); W3 = bodyW(1,3);
W4 = lforeW(1,1); W5 = lforeW(1,2); W6 = lforeW(1,3);
W7 = rforeW(1,1); W8 = rforeW(1,2); W9 = rforeW(1,3);
W10 = lhindW(1,1); W11 = lhindW(1,2); W12 = lhindW(1,3);
W13 = rhindW(1,1); W14 = rhindW(1,2); W15 = rhindW(1,3);

H1 = bodyH(1,1); H2 = bodyH(1,2); H3 = bodyH(1,3);
H4 = lforeH(1,1); H5 = lforeH(1,2); H6 = lforeH(1,3);
H7 = rforeH(1,1); H8 = rforeH(1,2); H9 = rforeH(1,3);
H10 = lhindH(1,1); H11 = lhindH(1,2); H12 = lhindH(1,3);
H13 = rhindH(1,1); H14 = rhindH(1,2); H15 = rhindH(1,3);

shoulderX = shopelP(1,1); shoulderY = shopelP(1,2); pelvicX = shopelP(1,3); pelvicY = shopelP(1,4);

% Com = [ (m12*(q1 + (L2*cos(q3 + q4))/2 + pelvicX*cos(q3 + q4) + L1*cos(q3) + pelvicY*sin(q3 + q4) + (L12*cos(q24)*cos(q26))/2 + L10*sin(q3 + q4 + q20)*cos(q21) - (L12*sin(q24)*sin(q25)*sin(q26))/2 + L11*cos(q3 + q4 + q20)*cos(q22)*cos(q23) - L11*sin(q3 + q4 + q20)*cos(q21)*sin(q23) - L11*sin(q3 + q4 + q20)*cos(q23)*sin(q21)*sin(q22)) + m15*(q1 + (L2*cos(q3 + q4))/2 + pelvicX*cos(q3 + q4) + L1*cos(q3) - pelvicY*sin(q3 + q4) + (L15*cos(q31)*cos(q33))/2 - L13*sin(q3 + q4 + q27)*cos(q28) - (L15*sin(q31)*sin(q32)*sin(q33))/2 + L14*cos(q3 + q4 + q27)*cos(q29)*cos(q30) - L14*sin(q3 + q4 + q27)*cos(q28)*sin(q30) - L14*sin(q3 + q4 + q27)*cos(q30)*sin(q28)*sin(q29)) + m1*(q1 + (L1*cos(q3))/2) + m3*(q1 + L2*cos(q3 + q4) + L1*cos(q3) + (L3*cos(q3 + q4 + q5))/2) + m4*(q1 + cos(q3)*(L1/2 + shoulderX) + shoulderY*sin(q3) + (L4*sin(q3 + q6)*cos(q7))/2) + m7*(q1 + cos(q3)*(L1/2 + shoulderX) - shoulderY*sin(q3) - (L7*sin(q3 + q13)*cos(q14))/2) + m2*(q1 + (L2*cos(q3 + q4))/2 + L1*cos(q3)) + m11*(q1 + (L2*cos(q3 + q4))/2 + pelvicX*cos(q3 + q4) + L1*cos(q3) + pelvicY*sin(q3 + q4) + L10*sin(q3 + q4 + q20)*cos(q21) + (L11*cos(q3 + q4 + q20)*cos(q22)*cos(q23))/2 - (L11*sin(q3 + q4 + q20)*cos(q21)*sin(q23))/2 - (L11*sin(q3 + q4 + q20)*cos(q23)*sin(q21)*sin(q22))/2) + m14*(q1 + (L2*cos(q3 + q4))/2 + pelvicX*cos(q3 + q4) + L1*cos(q3) - pelvicY*sin(q3 + q4) - L13*sin(q3 + q4 + q27)*cos(q28) + (L14*cos(q3 + q4 + q27)*cos(q29)*cos(q30))/2 - (L14*sin(q3 + q4 + q27)*cos(q28)*sin(q30))/2 - (L14*sin(q3 + q4 + q27)*cos(q30)*sin(q28)*sin(q29))/2) + m6*(q1 - (L6*(cos(q10)*cos(q12) - sin(q10)*sin(q11)*sin(q12)))/2 + L5*(sin(q3 + q6)*cos(q7)*sin(q9) - cos(q3 + q6)*cos(q8)*cos(q9) + sin(q3 + q6)*cos(q9)*sin(q7)*sin(q8)) + cos(q3)*(L1/2 + shoulderX) + shoulderY*sin(q3) + L4*sin(q3 + q6)*cos(q7)) + m9*(q1 - (L9*(cos(q17)*cos(q19) - sin(q17)*sin(q18)*sin(q19)))/2 + L8*(sin(q3 + q13)*cos(q14)*sin(q16) - cos(q3 + q13)*cos(q15)*cos(q16) + sin(q3 + q13)*cos(q16)*sin(q14)*sin(q15)) + cos(q3)*(L1/2 + shoulderX) - shoulderY*sin(q3) - L7*sin(q3 + q13)*cos(q14)) + m5*(q1 + (L1*cos(q3))/2 + shoulderX*cos(q3) + shoulderY*sin(q3) + L4*sin(q3 + q6)*cos(q7) + (L5*sin(q3 + q6)*cos(q7)*sin(q9))/2 - (L5*cos(q3 + q6)*cos(q8)*cos(q9))/2 + (L5*sin(q3 + q6)*cos(q9)*sin(q7)*sin(q8))/2) + m8*(q1 + (L1*cos(q3))/2 + shoulderX*cos(q3) - shoulderY*sin(q3) - L7*sin(q3 + q13)*cos(q14) + (L8*sin(q3 + q13)*cos(q14)*sin(q16))/2 - (L8*cos(q3 + q13)*cos(q15)*cos(q16))/2 + (L8*sin(q3 + q13)*cos(q16)*sin(q14)*sin(q15))/2) + m10*(q1 + cos(q3 + q4)*(L2/2 + pelvicX) + L1*cos(q3) + pelvicY*sin(q3 + q4) + (L10*sin(q3 + q4 + q20)*cos(q21))/2) + m13*(q1 + cos(q3 + q4)*(L2/2 + pelvicX) + L1*cos(q3) - pelvicY*sin(q3 + q4) - (L13*sin(q3 + q4 + q27)*cos(q28))/2))/(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8 + m9 + m10 + m11 + m12 + m13 + m14 + m15)
%  (m12*(q2 + (L2*sin(q3 + q4))/2 - pelvicY*cos(q3 + q4) + pelvicX*sin(q3 + q4) + L1*sin(q3) + (L12*cos(q26)*sin(q24))/2 - L10*cos(q3 + q4 + q20)*cos(q21) + (L12*cos(q24)*sin(q25)*sin(q26))/2 + L11*cos(q3 + q4 + q20)*cos(q21)*sin(q23) + L11*sin(q3 + q4 + q20)*cos(q22)*cos(q23) + L11*cos(q3 + q4 + q20)*cos(q23)*sin(q21)*sin(q22)) - m5*(shoulderY*cos(q3) - (L1*sin(q3))/2 - q2 - shoulderX*sin(q3) + L4*cos(q3 + q6)*cos(q7) + (L5*cos(q3 + q6)*cos(q7)*sin(q9))/2 + (L5*sin(q3 + q6)*cos(q8)*cos(q9))/2 + (L5*cos(q3 + q6)*cos(q9)*sin(q7)*sin(q8))/2) + m15*(q2 + (L2*sin(q3 + q4))/2 + pelvicY*cos(q3 + q4) + pelvicX*sin(q3 + q4) + L1*sin(q3) + (L15*cos(q33)*sin(q31))/2 + L13*cos(q3 + q4 + q27)*cos(q28) + (L15*cos(q31)*sin(q32)*sin(q33))/2 + L14*cos(q3 + q4 + q27)*cos(q28)*sin(q30) + L14*sin(q3 + q4 + q27)*cos(q29)*cos(q30) + L14*cos(q3 + q4 + q27)*cos(q30)*sin(q28)*sin(q29)) + m4*(q2 - shoulderY*cos(q3) + sin(q3)*(L1/2 + shoulderX) - (L4*cos(q3 + q6)*cos(q7))/2) + m7*(q2 + shoulderY*cos(q3) + sin(q3)*(L1/2 + shoulderX) + (L7*cos(q3 + q13)*cos(q14))/2) + m1*(q2 + (L1*sin(q3))/2) + m3*(q2 + L2*sin(q3 + q4) + L1*sin(q3) + (L3*sin(q3 + q4 + q5))/2) + m11*(q2 + (L2*sin(q3 + q4))/2 - pelvicY*cos(q3 + q4) + pelvicX*sin(q3 + q4) + L1*sin(q3) - L10*cos(q3 + q4 + q20)*cos(q21) + (L11*cos(q3 + q4 + q20)*cos(q21)*sin(q23))/2 + (L11*sin(q3 + q4 + q20)*cos(q22)*cos(q23))/2 + (L11*cos(q3 + q4 + q20)*cos(q23)*sin(q21)*sin(q22))/2) + m14*(q2 + (L2*sin(q3 + q4))/2 + pelvicY*cos(q3 + q4) + pelvicX*sin(q3 + q4) + L1*sin(q3) + L13*cos(q3 + q4 + q27)*cos(q28) + (L14*cos(q3 + q4 + q27)*cos(q28)*sin(q30))/2 + (L14*sin(q3 + q4 + q27)*cos(q29)*cos(q30))/2 + (L14*cos(q3 + q4 + q27)*cos(q30)*sin(q28)*sin(q29))/2) + m9*(q2 - (L9*(cos(q19)*sin(q17) + cos(q17)*sin(q18)*sin(q19)))/2 - L8*(cos(q3 + q13)*cos(q14)*sin(q16) + sin(q3 + q13)*cos(q15)*cos(q16) + cos(q3 + q13)*cos(q16)*sin(q14)*sin(q15)) + shoulderY*cos(q3) + sin(q3)*(L1/2 + shoulderX) + L7*cos(q3 + q13)*cos(q14)) + m2*(q2 + (L2*sin(q3 + q4))/2 + L1*sin(q3)) + m8*(q2 + (L1*sin(q3))/2 + shoulderY*cos(q3) + shoulderX*sin(q3) + L7*cos(q3 + q13)*cos(q14) - (L8*cos(q3 + q13)*cos(q14)*sin(q16))/2 - (L8*sin(q3 + q13)*cos(q15)*cos(q16))/2 - (L8*cos(q3 + q13)*cos(q16)*sin(q14)*sin(q15))/2) + m10*(q2 - pelvicY*cos(q3 + q4) + sin(q3 + q4)*(L2/2 + pelvicX) + L1*sin(q3) - (L10*cos(q3 + q4 + q20)*cos(q21))/2) + m13*(q2 + pelvicY*cos(q3 + q4) + sin(q3 + q4)*(L2/2 + pelvicX) + L1*sin(q3) + (L13*cos(q3 + q4 + q27)*cos(q28))/2) - m6*((L6*(cos(q12)*sin(q10) + cos(q10)*sin(q11)*sin(q12)))/2 - q2 + L5*(cos(q3 + q6)*cos(q7)*sin(q9) + sin(q3 + q6)*cos(q8)*cos(q9) + cos(q3 + q6)*cos(q9)*sin(q7)*sin(q8)) + shoulderY*cos(q3) - sin(q3)*(L1/2 + shoulderX) + L4*cos(q3 + q6)*cos(q7)))/(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8 + m9 + m10 + m11 + m12 + m13 + m14 + m15)
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -(m6*(L5*(sin(q7)*sin(q9) - cos(q7)*cos(q9)*sin(q8)) + L4*sin(q7) - (L6*cos(q11)*sin(q12))/2) - m9*(L7*sin(q14) - L8*(sin(q14)*sin(q16) - cos(q14)*cos(q16)*sin(q15)) + (L9*cos(q18)*sin(q19))/2) + m12*(L10*sin(q21) - L11*(sin(q21)*sin(q23) - cos(q21)*cos(q23)*sin(q22)) + (L12*cos(q25)*sin(q26))/2) - m15*(L14*(sin(q28)*sin(q30) - cos(q28)*cos(q30)*sin(q29)) + L13*sin(q28) - (L15*cos(q32)*sin(q33))/2) + m5*((L5*(sin(q7)*sin(q9) - cos(q7)*cos(q9)*sin(q8)))/2 + L4*sin(q7)) + m8*((L8*(sin(q14)*sin(q16) - cos(q14)*cos(q16)*sin(q15)))/2 - L7*sin(q14)) - m11*((L11*(sin(q21)*sin(q23) - cos(q21)*cos(q23)*sin(q22)))/2 - L10*sin(q21)) - m14*((L14*(sin(q28)*sin(q30) - cos(q28)*cos(q30)*sin(q29)))/2 + L13*sin(q28)) + (L4*m4*sin(q7))/2 - (L7*m7*sin(q14))/2 + (L10*m10*sin(q21))/2 - (L13*m13*sin(q28))/2)/(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8 + m9 + m10 + m11 + m12 + m13 + m14 + m15)];


c2x = (2*m4*shoulderX*cos(q3) + 2*m5*shoulderX*cos(q3) + 2*m6*shoulderX*cos(q3) + 2*m7*shoulderX*cos(q3) + 2*m8*shoulderX*cos(q3) + 2*m9*shoulderX*cos(q3) + 2*m4*shoulderY*sin(q3) + 2*m5*shoulderY*sin(q3) + 2*m6*shoulderY*sin(q3) - 2*m7*shoulderY*sin(q3) - 2*m8*shoulderY*sin(q3) - 2*m9*shoulderY*sin(q3) + L3*m3*cos(q3 + q4 + q5) + L2*m2*cos(q3 + q4) + 2*L2*m3*cos(q3 + q4) + L2*m10*cos(q3 + q4) + L2*m11*cos(q3 + q4) + L2*m12*cos(q3 + q4) + L2*m13*cos(q3 + q4) + L2*m14*cos(q3 + q4) + L2*m15*cos(q3 + q4) + 2*m10*pelvicX*cos(q3 + q4) + 2*m11*pelvicX*cos(q3 + q4) + 2*m12*pelvicX*cos(q3 + q4) + 2*m13*pelvicX*cos(q3 + q4) + 2*m14*pelvicX*cos(q3 + q4) + 2*m15*pelvicX*cos(q3 + q4) + L1*m1*cos(q3) + 2*L1*m2*cos(q3) + 2*L1*m3*cos(q3) + L1*m4*cos(q3) + L1*m5*cos(q3) + L1*m6*cos(q3) + L1*m7*cos(q3) + L1*m8*cos(q3) + L1*m9*cos(q3) + 2*L1*m10*cos(q3) + 2*L1*m11*cos(q3) + 2*L1*m12*cos(q3) + 2*L1*m13*cos(q3) + 2*L1*m14*cos(q3) + 2*L1*m15*cos(q3) + 2*m10*pelvicY*sin(q3 + q4) + 2*m11*pelvicY*sin(q3 + q4) + 2*m12*pelvicY*sin(q3 + q4) - 2*m13*pelvicY*sin(q3 + q4) - 2*m14*pelvicY*sin(q3 + q4) - 2*m15*pelvicY*sin(q3 + q4) + L10*m10*sin(q3 + q4 + q20)*cos(q21) + 2*L10*m11*sin(q3 + q4 + q20)*cos(q21) + 2*L10*m12*sin(q3 + q4 + q20)*cos(q21) - L13*m13*sin(q3 + q4 + q27)*cos(q28) - 2*L13*m14*sin(q3 + q4 + q27)*cos(q28) - 2*L13*m15*sin(q3 + q4 + q27)*cos(q28) + L4*m4*sin(q3 + q6)*cos(q7) + 2*L4*m5*sin(q3 + q6)*cos(q7) + 2*L4*m6*sin(q3 + q6)*cos(q7) - L7*m7*sin(q3 + q13)*cos(q14) - 2*L7*m8*sin(q3 + q13)*cos(q14) - 2*L7*m9*sin(q3 + q13)*cos(q14) - L6*m6*cos(q10)*cos(q12) - L9*m9*cos(q17)*cos(q19) + L12*m12*cos(q24)*cos(q26) + L15*m15*cos(q31)*cos(q33) - L5*m5*cos(q3 + q6)*cos(q8)*cos(q9) - 2*L5*m6*cos(q3 + q6)*cos(q8)*cos(q9) - L8*m8*cos(q3 + q13)*cos(q15)*cos(q16) - 2*L8*m9*cos(q3 + q13)*cos(q15)*cos(q16) + L5*m5*sin(q3 + q6)*cos(q7)*sin(q9) + 2*L5*m6*sin(q3 + q6)*cos(q7)*sin(q9) + L8*m8*sin(q3 + q13)*cos(q14)*sin(q16) + 2*L8*m9*sin(q3 + q13)*cos(q14)*sin(q16) + L6*m6*sin(q10)*sin(q11)*sin(q12) + L9*m9*sin(q17)*sin(q18)*sin(q19) - L12*m12*sin(q24)*sin(q25)*sin(q26) - L15*m15*sin(q31)*sin(q32)*sin(q33) + L11*m11*cos(q3 + q4 + q20)*cos(q22)*cos(q23) + 2*L11*m12*cos(q3 + q4 + q20)*cos(q22)*cos(q23) + L14*m14*cos(q3 + q4 + q27)*cos(q29)*cos(q30) + 2*L14*m15*cos(q3 + q4 + q27)*cos(q29)*cos(q30) - L11*m11*sin(q3 + q4 + q20)*cos(q21)*sin(q23) - 2*L11*m12*sin(q3 + q4 + q20)*cos(q21)*sin(q23) - L14*m14*sin(q3 + q4 + q27)*cos(q28)*sin(q30) - 2*L14*m15*sin(q3 + q4 + q27)*cos(q28)*sin(q30) + L5*m5*sin(q3 + q6)*cos(q9)*sin(q7)*sin(q8) + 2*L5*m6*sin(q3 + q6)*cos(q9)*sin(q7)*sin(q8) + L8*m8*sin(q3 + q13)*cos(q16)*sin(q14)*sin(q15) + 2*L8*m9*sin(q3 + q13)*cos(q16)*sin(q14)*sin(q15) - L11*m11*sin(q3 + q4 + q20)*cos(q23)*sin(q21)*sin(q22) - 2*L11*m12*sin(q3 + q4 + q20)*cos(q23)*sin(q21)*sin(q22) - L14*m14*sin(q3 + q4 + q27)*cos(q30)*sin(q28)*sin(q29) - 2*L14*m15*sin(q3 + q4 + q27)*cos(q30)*sin(q28)*sin(q29))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8 + m9 + m10 + m11 + m12 + m13 + m14 + m15));
c2y = (2*m7*shoulderY*cos(q3) - 2*m5*shoulderY*cos(q3) - 2*m6*shoulderY*cos(q3) - 2*m4*shoulderY*cos(q3) + 2*m8*shoulderY*cos(q3) + 2*m9*shoulderY*cos(q3) + 2*m4*shoulderX*sin(q3) + 2*m5*shoulderX*sin(q3) + 2*m6*shoulderX*sin(q3) + 2*m7*shoulderX*sin(q3) + 2*m8*shoulderX*sin(q3) + 2*m9*shoulderX*sin(q3) + L3*m3*sin(q3 + q4 + q5) + L2*m2*sin(q3 + q4) + 2*L2*m3*sin(q3 + q4) + L2*m10*sin(q3 + q4) + L2*m11*sin(q3 + q4) + L2*m12*sin(q3 + q4) + L2*m13*sin(q3 + q4) + L2*m14*sin(q3 + q4) + L2*m15*sin(q3 + q4) - 2*m10*pelvicY*cos(q3 + q4) - 2*m11*pelvicY*cos(q3 + q4) - 2*m12*pelvicY*cos(q3 + q4) + 2*m13*pelvicY*cos(q3 + q4) + 2*m14*pelvicY*cos(q3 + q4) + 2*m15*pelvicY*cos(q3 + q4) + 2*m10*pelvicX*sin(q3 + q4) + 2*m11*pelvicX*sin(q3 + q4) + 2*m12*pelvicX*sin(q3 + q4) + 2*m13*pelvicX*sin(q3 + q4) + 2*m14*pelvicX*sin(q3 + q4) + 2*m15*pelvicX*sin(q3 + q4) + L1*m1*sin(q3) + 2*L1*m2*sin(q3) + 2*L1*m3*sin(q3) + L1*m4*sin(q3) + L1*m5*sin(q3) + L1*m6*sin(q3) + L1*m7*sin(q3) + L1*m8*sin(q3) + L1*m9*sin(q3) + 2*L1*m10*sin(q3) + 2*L1*m11*sin(q3) + 2*L1*m12*sin(q3) + 2*L1*m13*sin(q3) + 2*L1*m14*sin(q3) + 2*L1*m15*sin(q3) - L10*m10*cos(q3 + q4 + q20)*cos(q21) - 2*L10*m11*cos(q3 + q4 + q20)*cos(q21) - 2*L10*m12*cos(q3 + q4 + q20)*cos(q21) + L13*m13*cos(q3 + q4 + q27)*cos(q28) + 2*L13*m14*cos(q3 + q4 + q27)*cos(q28) + 2*L13*m15*cos(q3 + q4 + q27)*cos(q28) - L4*m4*cos(q3 + q6)*cos(q7) - 2*L4*m5*cos(q3 + q6)*cos(q7) - 2*L4*m6*cos(q3 + q6)*cos(q7) + L7*m7*cos(q3 + q13)*cos(q14) + 2*L7*m8*cos(q3 + q13)*cos(q14) + 2*L7*m9*cos(q3 + q13)*cos(q14) - L6*m6*cos(q12)*sin(q10) - L9*m9*cos(q19)*sin(q17) + L12*m12*cos(q26)*sin(q24) + L15*m15*cos(q33)*sin(q31) - L5*m5*cos(q3 + q6)*cos(q7)*sin(q9) - L5*m5*sin(q3 + q6)*cos(q8)*cos(q9) - 2*L5*m6*cos(q3 + q6)*cos(q7)*sin(q9) - 2*L5*m6*sin(q3 + q6)*cos(q8)*cos(q9) - L8*m8*cos(q3 + q13)*cos(q14)*sin(q16) - L8*m8*sin(q3 + q13)*cos(q15)*cos(q16) - 2*L8*m9*cos(q3 + q13)*cos(q14)*sin(q16) - 2*L8*m9*sin(q3 + q13)*cos(q15)*cos(q16) - L6*m6*cos(q10)*sin(q11)*sin(q12) - L9*m9*cos(q17)*sin(q18)*sin(q19) + L12*m12*cos(q24)*sin(q25)*sin(q26) + L15*m15*cos(q31)*sin(q32)*sin(q33) + L11*m11*cos(q3 + q4 + q20)*cos(q21)*sin(q23) + L11*m11*sin(q3 + q4 + q20)*cos(q22)*cos(q23) + 2*L11*m12*cos(q3 + q4 + q20)*cos(q21)*sin(q23) + 2*L11*m12*sin(q3 + q4 + q20)*cos(q22)*cos(q23) + L14*m14*cos(q3 + q4 + q27)*cos(q28)*sin(q30) + L14*m14*sin(q3 + q4 + q27)*cos(q29)*cos(q30) + 2*L14*m15*cos(q3 + q4 + q27)*cos(q28)*sin(q30) + 2*L14*m15*sin(q3 + q4 + q27)*cos(q29)*cos(q30) - L5*m5*cos(q3 + q6)*cos(q9)*sin(q7)*sin(q8) - 2*L5*m6*cos(q3 + q6)*cos(q9)*sin(q7)*sin(q8) - L8*m8*cos(q3 + q13)*cos(q16)*sin(q14)*sin(q15) - 2*L8*m9*cos(q3 + q13)*cos(q16)*sin(q14)*sin(q15) + L11*m11*cos(q3 + q4 + q20)*cos(q23)*sin(q21)*sin(q22) + 2*L11*m12*cos(q3 + q4 + q20)*cos(q23)*sin(q21)*sin(q22) + L14*m14*cos(q3 + q4 + q27)*cos(q30)*sin(q28)*sin(q29) + 2*L14*m15*cos(q3 + q4 + q27)*cos(q30)*sin(q28)*sin(q29))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8 + m9 + m10 + m11 + m12 + m13 + m14 + m15));

Nq1 = ObComX - c2x;
Nq2 = ObComY - c2y;

virXY = [Nq1; Nq2];